---
name: 实现FilterByImageWidth操作符核心类
status: open
created: 2025-09-03T05:43:35Z
updated: 2025-09-03T05:58:42Z
github: https://github.com/yyq19990828/PaddleOCR/issues/2
depends_on: []
parallel: false
conflicts_with: []
---

# Task: 实现FilterByImageWidth操作符核心类

## Description

在ppocr/data/imaug/operators.py中实现FilterByImageWidth操作符类，支持基于图片宽度的过滤功能。该操作符需要支持三种配置格式：[min, max]闭区间、[min, ]开区间、None禁用过滤。

## Acceptance Criteria

- [ ] 创建FilterByImageWidth类，继承自适当的基类
- [ ] 实现__init__方法，解析width_range配置参数
- [ ] 实现__call__方法，执行图片宽度检查逻辑
- [ ] 支持[min, max]配置格式（闭区间过滤）
- [ ] 支持[min, ]配置格式（开区间过滤，保留>=min的图片）
- [ ] 支持None配置（禁用过滤，直接返回原数据）
- [ ] 不符合条件时返回None以触发跳过机制
- [ ] 添加参数验证和错误处理

## Technical Details

**实现位置**: `ppocr/data/imaug/operators.py`

**核心逻辑**:
```python
class FilterByImageWidth:
    def __init__(self, width_range=None, **kwargs):
        self.width_range = width_range
        # 参数验证逻辑
        
    def __call__(self, data):
        if self.width_range is None:
            return data
            
        img = data['image']
        width = img.shape[1]  # 获取图片宽度
        
        # 根据width_range配置进行过滤判断
        if not self._is_width_in_range(width):
            return None  # 触发跳过机制
            
        return data
```

**配置解析**:
- `[min, max]`: 保留min <= width <= max的图片
- `[min, ]`: 保留width >= min的图片  
- `None`: 不进行过滤

**依赖要求**: 需要在DecodeImage操作符之后执行，确保image字段已经包含解码后的图像数据

## Dependencies

- [ ] 确认ppocr/data/imaug/operators.py文件结构
- [ ] 理解现有操作符的实现模式
- [ ] 确认DecodeImage操作符的输出数据格式

## Effort Estimate

- Size: M
- Hours: 6小时
- Parallel: false（核心实现，其他任务依赖此任务）

## Definition of Done

- [ ] FilterByImageWidth类实现完成
- [ ] 支持所有三种配置格式
- [ ] 参数验证和错误处理完整
- [ ] 代码遵循PaddleOCR编码规范
- [ ] 添加适当的类和方法注释
- [ ] 本地测试验证基本功能正常